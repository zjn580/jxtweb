$(function(){function F(){if(!E()){$(".mr_container [placeholder]").focus(function(){var i=$(this);if(i.val()==i.attr("placeholder")){i.val("");i.css("color","#333")}else{i.css("color","#333")}}).blur(function(){var i=$(this);if(i.val()==""||i.val()==i.attr("placeholder")){i.val(i.attr("placeholder"));i.css("color","#b5b5b5")}}).blur()}if($("[placeholder]").value===""){$("[placeholder]").value=$("[placeholder]").attr("placeholder")}}function E(){return"placeholder" in document.createElement("input")}F();$(".work .mr_workexpFormTop:first,.education .mr_educationFormTop:first,.practice .mr_practiceConFormTop:first").removeClass("dashedBorder");var c=$.trim($(".selfCon").find("textarea").val()).length;var u=$(".word_count").text();if($.trim($(".selfCon").find("textarea").val())=="一句话介绍自己，告诉我为什么选择你而不是别人"){c=0}$(".word_count").text(u-c);var w=$("#isWork");var y=w.val();var G=$("#indentity").val();if(y=="0"){switch(G){case"":$(".mr_threeBasic").css("height","444px");break;case"1":$(".mr_enoughWidth").animate({marginLeft:"0"},0);var B=$(".education .mr_educationForm").length;if(B==1){$(".mr_threeBasic").css("height","444px")}else{$(".mr_threeBasic").css("height","auto")}break;case"2":$(".mr_enoughWidth").animate({marginLeft:"-540px"},0);$(".mr_icon li:eq(1)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon");var B=$(".practice .mr_practiceConForm").length;if(B==1){$(".mr_threeBasic").css("height","440px")}else{$(".mr_threeBasic").css("height","auto")}break;case"3":$(".mr_enoughWidth").animate({marginLeft:"-1080px"},0);$(".mr_icon li:eq(2)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon");$(".mr_threeBasic").css("height","440px");break}}else{switch(G){case"":$(".mr_threeBasic").css("height","444px");break;case"1":$(".mr_enoughWidth").animate({marginLeft:"0"},0);var C=$(".work .mr_workexpForm").length;if(C==1){$(".mr_threeBasic").css("height","444px")}else{$(".mr_threeBasic").css("height","auto")}break;case"2":$(".mr_enoughWidth").animate({marginLeft:"-540px"},0);$(".mr_icon li:eq(1)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon");var t=$(".education .mr_educationForm").length;if(t==1){$(".mr_threeBasic").css("height","440px")}else{$(".mr_threeBasic").css("height","auto")}break;case"3":$(".mr_enoughWidth").animate({marginLeft:"-1080px"},0);$(".mr_icon li:eq(2)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon");$(".mr_threeBasic").css("height","440px");break}}$(".mr_t .mr_button a").hover(function(){$(this).css("color","#333")},function(){$(this).css("color","#999")});var k=new components.CityWrapper({container:$("#selectCity"),onchange:function(J,i){i.find(".error").hide()},beforeShown:function(K,J){$(".selUl").not(":hidden").hide();$(".selUl").siblings('input[type="button"]').removeClass("select_color");$(".selUl").siblings('input[type="button"]').removeClass("select_color");K.find('input[type="button"]').addClass("select_color");var i=$(".mr_basic").find('input[type="text"]');i.removeClass("select_color")},afterHide:function(J,i){var K=J.find('input[type="button"]');K.removeClass("select_color");var L=K.val();if(L!=""&&L!="所在城市"){K.css("color","#333")}}});$(document).click(function(){$(".selUl,.mr_calendar_ym").hide();k.hide();$('.mrWork,input[type="text"],.practiceDate input[type="button"],.workDate input[type="button"]').removeClass("select_color");$(".mr_introduceSelf textarea").removeClass("select_color").css("transition","border 0s ease-in 0s");$('.sel input[type="button"] ,.nextSel input[type="button"]').removeClass("select_color")});$(".mr_basicform").on("click",'input[type="text"]',function(i){i.stopPropagation();$('.mr_basicform input[type="text"]').removeClass("select_color");$(this).addClass("select_color");k.hide();$(".selUl").not(":hidden").css("display","none");$("#mrTopDegree,#mrWokrYear").removeClass("select_color")});var n=$(".num").val();$(".work").on("click",'input[type="text"]',function(L){L.stopPropagation();$('.work input[type="text"]').removeClass("select_color");$(this).addClass("select_color");if(n>0){for(var K=0;K<n;K++){o[K].hide()}}else{var J=$(".work .mr_workexpForm").length;for(var K=0;K<J;K++){o[K].hide()}}});$(".education").on("click",'input[type="text"]',function(i){i.stopPropagation();$('.education input[type="text"]').removeClass("select_color");$(this).addClass("select_color");$(".selUl").css("display","none");$('.mr_education input[type="button"]').removeClass("select_color")});$(".practice").on("click",'input[type="text"]',function(L){L.stopPropagation();$('.practice input[type="text"],.mr_workcity input[type="button"]').removeClass("select_color");$(this).addClass("select_color");if(n>0){for(var K=0;K<n;K++){I[K].hide()}}else{var J=$(".practice .mr_practiceConForm").length;for(var K=0;K<J;K++){I[K].hide()}}});$("#mr_introduceSelf textarea").click(function(i){i.stopPropagation();$(this).addClass("select_color")});$(".work").on("focus",'input[name="companyName"]',function(){var L=$(this);L.attr("fake","true");var K=L.offset().top-6;var i=L.offset().left+11;var J=$(".mrTips");J.fadeIn(90).find(".tips").css({left:i+452+"px",top:K})});$(".work").on("blur",'input[name="companyName"]',function(){var i=$(".mrTips");i.fadeOut(90);$(this).attr("fake","false")});window.onresize=function(){var J;var L=$("#isWork").val();if(L=="0"){J=$('.practice input[name="practiceName"]')}else{J=$('.work input[name="companyName"]')}for(var K=0;K<J.length;K++){if($(J[K]).attr("fake")=="true"){$(J[K]).focus()}}};$(".practice").on("focus",'input[name="practiceName"]',function(){var L=$(this);L.attr("fake","true");var K=L.offset().top-6;var i=L.offset().left+11;var J=$(".mrTips");J.fadeIn(90).find(".tips").css({left:i+452+"px",top:K})});$(".practice").on("blur",'input[name="practiceName"]',function(){var i=$(".mrTips");i.fadeOut(90);$(this).attr("fake","false")});$(".collapsible_menu").hover(function(){$(".logout").removeClass("dn");$(this).find("i").addClass("hover")},function(){$(".logout").addClass("dn");$(this).find("i").removeClass("hover")});$(".mr_headfile").hover(function(){$(".mr_headhover").show()},function(){$(".mr_headhover").hide()});var D=false;function b(K){var J=K.children("ul");var i=K.find('input[type="button"]');if(J.is(":visible")==false){$(".selUl").hide();$(".selUl").siblings('input[type="button"]').removeClass("select_color");i.removeClass("select_color");K.siblings().find('input[type="button"]').removeClass("select_color");K.css("zIndex","2");D=false}if(D){J.hide();i.removeClass("select_color");K.css("zIndex","2");D=false}else{J.show();i.addClass("select_color");K.css("zIndex","2");D=true}}function x(J,i){i.each(function(){var L=$(this);var K=L.text();if(K==J){L.addClass("mrColor")}})}$(".mr_basicform").on("click",".sel",function(K){K.stopPropagation();$('.mr_basicform input[type="text"]').removeClass("select_color");var J=$(this);b(J);if(D){$(this).find("ul").show()}else{$(this).find("ul").hide()}var M=$(".xl_list");if(M.is(":visible")){$('.mr_workcity input[type="button"]').removeClass("select_color");M.hide()}var L=$(this).find('input[type="button"]').val();var i=$(this).find("ul li");x(L,i)});$(".mr_basicform").on("click",".nextSel",function(K){K.stopPropagation();$('.mr_basicform input[type="text"]').removeClass("select_color");var J=$(this);b(J);if(D){$(this).find("ul").show()}else{$(this).find("ul").hide()}var M=$(".xl_list");if(M.is(":visible")){$('.mr_workcity input[type="button"]').removeClass("select_color");M.hide()}var L=$(this).find('input[type="button"]').val();var i=$(this).find("ul li");x(L,i)});$(".education").on("click",".sel",function(K){K=K||window.event;K.stopPropagation();$('.education input[type="text"]').removeClass("select_color");var J=$(this);b(J);if(D){$(this).find("ul").show()}else{$(this).find("ul").hide()}var L=$(this).find('input[type="button"]').val();var i=$(this).find("ul li");x(L,i)});$(".education").on("click",".nextSel",function(K){K=K||window.event;K.stopPropagation();$('.education input[type="text"]').removeClass("select_color");var J=$(this);b(J);if(D){$(this).find("ul").show()}else{$(this).find("ul").hide()}var L=$(this).find('input[type="button"]').val();var i=$(this).find("ul li");x(L,i)});function A(i){var K=i.text();i.parent("ul").siblings("input").val(K);i.parent("ul").siblings("label").find("input").val(K);i.parent("ul").siblings('input[type="button"]').css("color","#333");var K=i.parent("ul").siblings("input").val();var J=i.parent("ul").siblings("input");i.parent("ul").hide().siblings('input[type="button"]').removeClass("select_color");i.parent("ul").siblings("span.error").hide()}$(".mr_basicform").on("click",".sel ul li",function(i){i.stopPropagation();i.preventDefault();var J=$(this);A(J)});$(".education").on("click",".sel ul li",function(i){i.stopPropagation();i.preventDefault();var J=$(this);A(J)});$(".education").on("mouseover",".sel ul li",function(){var i=$(this);i.addClass("mrColor").siblings("li").removeClass("mrColor")});$(".mr_basicform").on("click",".nextSel ul li",function(J){J.preventDefault();J.stopPropagation();var i=$(this);var L=i.text();i.parent("ul").siblings("input").val(L);i.parent("ul").siblings("label").find("input").val(L);i.parent("ul").siblings('input[type="button"]').css("color","#333");var L=i.parent("ul").siblings("input").val();var K=i.parent("ul").siblings("input");if(L=="应届毕业生"){i.parents("form.mr_basicform").find("input#mrSaveThree").val("下一步：继续完善教育信息")}else{i.parents("form.mr_basicform").find("input#mrSaveThree").val("下一步：继续完善职业信息")}i.parent("ul").hide().siblings('input[type="button"]').removeClass("select_color");i.parent("ul").siblings("span.error").hide()});$(".mr_basicform").on("mouseover",".sel ul li",function(J){var i=$(this);i.addClass("mrColor").siblings("li").removeClass("mrColor")});$(".mr_basicform").on("mouseover",".nextSel ul li",function(J){var i=$(this);i.addClass("mrColor").siblings("li").removeClass("mrColor")});$(".education").on("click",".nextSel ul li",function(i){i.preventDefault();i.stopPropagation();var J=$(this);A(J)});$(".education").on("mouseover",".nextSel ul li",function(){var i=$(this);i.addClass("mrColor").siblings("li").removeClass("mrColor")});var H;$("#mrPhone").keyup(function(){var J=$.trim($(this).val());var i=$(".mr_basicform").validate().element($("#mrPhone"));var K=$('#selectCity input[type="button"]').val();if(!i){return}else{if(K!=""||K!="所在城市"){$.ajax({url:ctx+"/resume/mobileInfo.json",type:"get",data:{mobile:J,resubmitToken:globals.token},dataType:"json"}).done(function(L){if(null!=L.resubmitToken&&""!=L.resubmitToken){globals.token=L.resubmitToken}if(L.success){var N=L.content.city;H=L.content.city;var M=$(".mr_workcity");M.find('input[type="hidden"]').val(N);M.find('input[type="button"]').val(N).css("color","#333");$(".mr_workcity").find("span.error").hide()}else{$(".mr_workcity").find('input[type="button"]').val("所在城市")}})}}});$("#mrPhone").focus(function(){$(this).siblings(".tips").fadeIn(90)}).blur(function(){$(this).siblings(".tips").fadeOut(90)});$(".mr_basicform").validate({rules:{name:{required:true,newSpecialChar:true,rangeLenStr:[1,15]},topDegree:{required:true},wokrYear:{required:true},phone:{required:true,isMobile:true,maxlength:11},email:{required:true,email:true,maxlength:100},workCity:{required:false}},messages:{name:{required:"必填",newSpecialChar:"格式错误",rangeLenStr:"请输入真实姓名"},topDegree:{required:"必填"},wokrYear:{required:"必填"},phone:{required:"必填",isMobile:"目前仅支持11位有效中国大陆号码",maxlength:"目前仅支持11位有效中国大陆号码"},email:{required:"请输入常用邮箱地址",email:"请输入有效的邮箱地址",maxlength:"请输入100字以内的邮箱地址"}},errorPlacement:function(i,J){if(J.attr("name")=="topDegree"){i.appendTo(J.parents(".mr_topdegree"))}else{if(J.attr("name")=="wokrYear"){i.appendTo(J.parents(".mr_workyear"))}else{if(J.attr("name")=="workCity"){i.insertAfter(J.siblings("#mrWokrCityLabel"))}else{i.insertAfter(J.parent("div"))}}}}});$("#mrSaveBasic").click(function(){var i=$(".mr_basicform").valid();var J=$('.mr_basicform input[name="wokrYear"]').val();if(J=="应届毕业生"){ga("send","event","应届生","基本信息","backoff")}else{ga("send","event","非应届生","基本信息","backoff")}var M=$(this).attr("data-val");if(i){var L=$(".mr_basicform");var K=L.find("input#mrSaveBasic");m(L,M,K)}else{return false}});$("#mrSaveThree").click(function(){var i=$(".mr_basicform").valid();var J=$('.mr_basicform input[name="wokrYear"]').val();if(J=="应届毕业生"){ga("send","event","应届生","基本信息","step1")}else{ga("send","event","非应届生","基本信息","step1")}var M=$(this).attr("data-val");if(i){var L=$(".mr_basicform");var K=L.find("input#mrSaveThree");m(L,M,K)}else{return false}});function m(J,K,O){O.attr("disabled",true);var i=$('input[name="name"]',J).val();var M=$('input[name="topDegree"]',J).val();var L=$('input[name="wokrYear"]',J).val();var N=$('input[name="phone"]',J).val();var P=$('input[name="email"]',J).val();var R=$("#pageType").val();var Q=$('input[name="workCity"]',J).val();$.ajax({url:ctx+"/resume/basicMain.json",type:"POST",data:{name:i,highestEducation:M,workYear:L,phone:N,email:P,liveCity:Q,resubmitToken:globals.token,type:R,urlType:K,isBack:"2"},dataType:"json"}).done(function(S){if(null!=S.resubmitToken&&""!=S.resubmitToken){globals.token=S.resubmitToken}if(S.success){var T=S.content.url;window.location.href=T}else{alert(S.msg)}O.attr("disabled",false)})}var r=function(){$(".companyName").autocomplete({source:function(K,i){var J=new Array();$.ajax({type:"POST",async:false,url:sctx+"/suggestion",dataType:"jsonp",jsonp:"suggestCompanyback",data:{input:K.term,type:2,num:6}}).done(function(L){if(L!=null&&L!=undefined){for(var M in L){var O=L[M];if(O!=null&&O!=undefined&&O.length>0){for(var N in O){J.push(O[N].cont)}}}}i(J)})},minLength:1})};$(".mr_workexp").on("keyup",".companyName",function(){myresumeCommon.utils.throttle(r,[],this,300)});$(".practice").on("keyup",".companyName",function(){myresumeCommon.utils.throttle(r,[],this,300)});var s=function(){$(".yourPosition").autocomplete({source:function(K,i){var J=new Array();$.ajax({type:"POST",async:false,url:sctx+"/suggestion",dataType:"jsonp",jsonp:"suggestPositionback",data:{input:K.term,type:5,num:6}}).done(function(L){if(L!=null&&L!=undefined){for(var M in L){var O=L[M];if(O!=null&&O!=undefined&&O.length>0){for(var N in O){J.push(O[N].cont)}}}}i(J)})},minLength:1})};$(".mr_workexp").on("keyup",".yourPosition",function(){myresumeCommon.utils.throttle(s,[],this,300)});$(".practice").on("keyup",".yourPosition",function(){myresumeCommon.utils.throttle(s,[],this,300)});var v=$("#mrPhone").val();if(v){$("#mrPhone").trigger("keyup")}var g=function(){$(".schoolName").autocomplete({source:function(K,i){var J=new Array();$.ajax({type:"POST",async:false,url:sctx+"/suggestion",dataType:"jsonp",jsonp:"suggestCollegeback",data:{input:K.term,type:3,num:6}}).done(function(L){if(L!=null&&L!=undefined){for(var M in L){var O=L[M];if(O!=null&&O!=undefined&&O.length>0){for(var N in O){J.push(O[N].cont)}}}}i(J)})},minLength:1})};$(".mr_eduation").on("keyup",".schoolName",function(){myresumeCommon.utils.throttle(g,[],this,300)});$(".education").on("keyup",".schoolName",function(){myresumeCommon.utils.throttle(g,[],this,300)});var j=function(){$(".yourMajor").autocomplete({source:function(K,i){var J=new Array();$.ajax({type:"POST",async:false,url:sctx+"/suggestion",dataType:"jsonp",jsonp:"suggestMajorback",data:{input:K.term,type:4,num:6}}).done(function(L){if(L!=null&&L!=undefined){for(var M in L){var O=L[M];if(O!=null&&O!=undefined&&O.length>0){for(var N in O){J.push(O[N].cont)}}}}i(J)})},minLength:1})};$(".mr_eduation").on("keyup",".yourMajor",function(){myresumeCommon.utils.throttle(j,[],this,300)});$(".education").on("keyup",".yourMajor",function(){myresumeCommon.utils.throttle(j,[],this,300)});$(".work").on("click",".add",function(N){N.stopPropagation();var J=$(".work");var L=$(this);var O=parseInt($(".mr_threeBasic").css("height"))+$("#hiddenWorkForm").outerHeight(true);$(".mr_threeBasic").css("height",O);J.find(".adddel").before($("#hiddenWorkForm").html());F();f();var K=J.find(".mr_workexpForm:last");J.find(".mr_workexpForm:last .mr_workexpFormTop").css({borderTop:"1px dashed #ebebeb"});if(navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.match(/7./i)=="7."){K.find(".mr_workexpFormTop").css("marginTop","-15px")}var M=$(".work .mr_workexpForm:last").offset().top+"px";$("html,body").stop().animate({scrollTop:M},1000);J.find('input[type="text"]').removeClass("select_color");K.find('input[name="companyName"]').focus();K.find('input[name="companyName"]').addClass("select_color");var i=J.find(".mr_workexpForm").length;if(i>0){L.siblings(".mrworkdel").show()}$(".workDate").find('input[type="button"]').removeClass("select_color");o.push(new components.CalendarDouble({wrap:$(".work .workDate:last")}));K.find('input[name="companyName"]').addClass("select_color")});$(".work .mrworkdel").hover(function(){$(this).addClass("pos")},function(){$(this).removeClass("pos")});$(".work").on("click",".mrworkdel",function(){var L=$(this);var J=$(".work .mr_workexpForm:last input.workHidden").val();if(J==""){var K=parseInt($(".mr_threeBasic").css("height"))-$(".work .mr_workexpForm:last").outerHeight(true);$(".mr_threeBasic").css("height",K);L.parents(".adddel").prev(".mr_workexpForm").remove();$(".mrTips:not(:first):last").remove();var i=L.parents(".adddel").siblings(".mr_workexpForm").length;if(i==1){L.hide()}}else{$.ajax({type:"POST",url:ctx+"/workExperience/delExp.json",data:{id:J,resubmitToken:globals.token},dataType:"json"}).done(function(N){if(null!=N.resubmitToken&&""!=N.resubmitToken){globals.token=N.resubmitToken}if(N.success){var P=parseInt($(".mr_threeBasic").css("height"))-$(".work .mr_workexpForm:last").outerHeight(true);$(".mr_threeBasic").css("height",P);var O=L.parents(".adddel").prev(".mr_workexpForm");O.remove();var M=L.parents(".adddel").siblings(".mr_workexpForm").length;$(".mrTips:not(:first):last").remove();if(M==1){L.hide()}}else{alert(N.msg)}})}});function f(){$(".work .mr_workexpForm").each(function(){$(this).validate({rules:{groups:{time:"startTime endTime"},companyName:{required:true,maxlenStr:40},yourPosition:{required:true,maxlenStr:30},startTime:{required:true},endTime:{required:true}},messages:{companyName:{required:"必填",maxlenStr:"请输入有效的公司名称"},yourPosition:{required:"必填",maxlenStr:"请输入有效的职位名称"},startTime:{required:"必填"},endTime:{required:"必填"}},errorPlacement:function(i,J){$(".mr_threeBasic").css("height","auto");if(J.attr("name")=="startTime"){i.insertAfter(J.siblings(".mrStartTimeLabel"))}else{if(J.attr("name")=="endTime"){i.insertAfter(J.siblings(".mrEndTimeLabel"))}else{i.insertAfter(J)}}}})})}f();$(".work").on("click",'input[type="submit"]',function(){var i=true;$(".work .mr_workexpForm").each(function(){f();var K=$(this).valid();if(!K){i=false}});if(i){var J=$(".work");a(J)}});function a(J){J.find('input[type="submit"]').attr("disabled",true);var i=$(".mr_workexpFormTop",J);var L=$(".mr_workexpFormTop",J).length;var P=[];for(var M=0;M<L;M++){var R=$(i[M]).find('input[name="companyName"]').val();var Q=$(i[M]).find('input[name="yourPosition"]').val();var K=$(i[M]).find('input[name="startTime"]').val();var O=$(i[M]).find('input[name="endTime"]').val();var S=$(i[M]).find("input.workHidden").val();var N={};N.companyName=R;N.positionName=Q;N.startDate=K;N.endDate=O;N.id=S;P.push(N)}P=stringifyJSON(P);$.ajax({url:ctx+"/workExperience/saveWorkExpList.json",type:"post",data:{workExpJson:P,resubmitToken:globals.token,indVal:"2"},dataType:"json"}).done(function(V){if(null!=V.resubmitToken&&""!=V.resubmitToken){globals.token=V.resubmitToken}if(V.success){$(".mrTips").remove();var Y=V.content.workExperiences;var U=Y.length;var W=$(".work input.workHidden");for(var X=0;X<U;X++){$(W[X]).val(Y[X].id)}var T=$(".mr_eduation").outerHeight(true);$(".mr_enoughWidth").animate({marginLeft:"-540px"},300,function(){$(".mr_threeBasic").css("height",T)});$(".mr_icon li:eq(1)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon")}else{alert(V.msg)}J.find('input[type="submit"]').attr("disabled",false)})}var I=[];var o=[];if(y=="0"){if(n>0){for(var z=0;z<n;z++){I.push(new components.CalendarDouble({wrap:$(".practice .practiceDate:eq("+z+")")}))}}else{I.push(new components.CalendarDouble({wrap:$(".practice .practiceDate")}))}}else{if(n>0){for(var z=0;z<n;z++){o.push(new components.CalendarDouble({wrap:$(".work .workDate:eq("+z+")")}))}}else{o.push(new components.CalendarDouble({wrap:$(".work .workDate")}))}}$(".practice").on("click",".add",function(N){N.stopPropagation();var L=$(this);var J=$(".practice");var O=parseInt($(".mr_threeBasic").css("height"))+$("#hiddenPracticeForm").height();$(".mr_threeBasic").css("height",O);J.find(".adddel").before($("#hiddenPracticeForm").html());l();F();var K=J.find(".mr_practiceConForm:last");K.find(".mr_practiceConFormTop").css({borderTop:"1px dashed #ebebeb"});if(navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.match(/7./i)=="7."){K.find(".mr_practiceConFormTop").css("marginTop","-15px")}var M=K.offset().top+"px";$("html,body").stop().animate({scrollTop:M},1000);J.find('input[type="text"]').removeClass("select_color");K.find('input[name="practiceName"]').focus();K.find('input[name="practiceName"]').addClass("select_color");var i=J.find(".mr_practiceConForm").length;if(i>0){L.siblings(".mrworkdel").show()}$(".practiceDate").find('input[type="button"]').removeClass("select_color");I.push(new components.CalendarDouble({wrap:$(".practice .practiceDate:last")}))});$(".mr_practiceForm label").click(function(K){K.preventDefault();var L=$(this).find("input");var i=L.prop("checked");if(i){$("#mr_check").prop("checked",false);L.siblings("em").addClass("pos");$('.mr_practiceConForm input[type="text"]').attr("disabled",true);$(".practice").off("click",".add",addmorePrac);$('.practice .addPracticekExp,.practice input[type="button"]').css("cursor","default");for(var J=0;J<I.length;J++){I[J].disable()}}else{$("#mr_check").prop("checked",true);L.siblings("em").removeClass("pos");$('.mr_practiceConForm input[type="text"]').attr("disabled",false);$(".practice").on("click",".add",addmorePrac);for(var J=0;J<I.length;J++){I[J].enable()}$('.practice input[type="button"],.practice .addPracticekExp').css("cursor","pointer")}});$(".practice .mrworkdel").hover(function(){$(this).addClass("pos")},function(){$(this).removeClass("pos")});$(".practice").on("click",".mrworkdel",function(){var J=$(".practice .mr_practiceConForm:last input.practiceHidden").val();var L=$(this);if(J==""){var K=parseInt($(".mr_threeBasic").css("height"))-$(".practice .mr_practiceConForm:last").outerHeight(true);$(".mr_threeBasic").css("height",K);var L=$(this);L.parents(".adddel").prev(".mr_practiceConForm").remove();var i=L.parents(".adddel").siblings(".mr_practiceConForm").length;$(".mrTips:not(:first):last").remove();if(i==1){L.hide()}}else{$.ajax({type:"POST",url:ctx+"/workExperience/delExp.json",data:{id:J,resubmitToken:globals.token},dataType:"json"}).done(function(N){if(null!=N.resubmitToken&&""!=N.resubmitToken){globals.token=N.resubmitToken}if(N.success){var O=parseInt($(".mr_threeBasic").css("height"))-$(".practice .mr_practiceConForm:last").outerHeight(true);$(".mr_threeBasic").css("height",O);L.parents(".adddel").prev(".mr_practiceConForm").remove();var M=L.parents(".adddel").siblings(".mr_practiceConForm").length;$(".mrTips:not(:first):last").remove();if(M==1){L.hide()}}else{alert(N.msg)}})}});function l(){$(".mr_practiceConForm").each(function(){$(this).validate({rules:{practiceName:{required:true,maxlenStr:40},practicePosition:{required:true,maxlenStr:30},startTime:{required:true},endTime:{required:true}},messages:{practiceName:{required:"必填",maxlenStr:"请输入有效的公司名称"},practicePosition:{required:"必填",maxlenStr:"请输入有效的职位名称"},startTime:{required:"必填"},endTime:{required:"必填"}},errorPlacement:function(i,J){$(".mr_threeBasic").css("height","auto");if(J.attr("name")=="startTime"){i.insertAfter(J.siblings(".mrPracticekStartTimeLabel"))}else{if(J.attr("name")=="endTime"){i.insertAfter(J.siblings(".mrPracticekEndTimeLabel"))}else{i.insertAfter(J)}}}})})}l();$('.practice input[type="submit"]').on("click",function(){var i=true;var J=$(".mr_practiceForm em").hasClass("pos");if(J){i=true}else{$(".practice .mr_practiceConForm").each(function(){l();var L=$(this).valid();if(!L){i=false}})}if(i){var K=$(".practice");e(K)}});function e(K){K.find('input[type="submit"]').attr("disabled",true);var J=$(".mr_practiceConFormTop",K);var M=$(".mr_practiceConFormTop",K).length;var i=$(".mr_practiceForm em").hasClass("pos");var R;i?R=false:R=true;var Q=[];for(var N=0;N<M;N++){var U=$(J[N]).find('input[name="practiceName"]').val();var T=$(J[N]).find('input[name="practicePosition"]').val();var L=$(J[N]).find('input[name="startTime"]').val();var P=$(J[N]).find('input[name="endTime"]').val();var S=$(J[N]).find("input.practiceHidden").val();var O={};O.companyName=U;O.positionName=T;O.startDate=L;O.endDate=P;O.id=S;Q.push(O)}Q=stringifyJSON(Q);$.ajax({url:ctx+"/workExperience/saveWorkExpList.json",type:"post",data:{workExpJson:Q,resubmitToken:globals.token,indVal:"3",hasPractice:R},dataType:"json"}).done(function(W){if(null!=W.resubmitToken&&""!=W.resubmitToken){globals.token=W.resubmitToken}if(W.success){$(".mrTips").remove();var Z=W.content.workExperiences;var V=Z.length;var Y=$(".practice input.practiceHidden");for(var X=0;X<V;X++){$(Y[X]).val(Z[X].id)}$(".mr_enoughWidth").animate({marginLeft:"-1080px"},300,function(){$(".mr_threeBasic").css("height","444px")});$(".mr_icon li:eq(2)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon")}else{$(".mr_enoughWidth").animate({marginLeft:"-1080px"},300,function(){$(".mr_threeBasic").css("height","444px")});$(".mr_icon li:eq(2)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon")}K.find('input[type="submit"]').attr("disabled",false)})}$(".education").on("click",".add",function(N){N.stopPropagation();var J=$(".education");var L=$(this);var O=parseInt($(".mr_threeBasic").css("height"))+$("#hiddenEduForm").outerHeight(true);$(".mr_threeBasic").css("height",O);J.find(".adddel").before($("#hiddenEduForm").html());h();F();var K=J.find(".mr_educationForm:last");K.find(".mr_educationFormTop").css({borderTop:"1px dashed #ebebeb"});if(navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.match(/7./i)=="7."){K.find(".mr_educationFormTop").css("marginTop","-15px")}var M=K.offset().top+"px";$("html,body").stop().animate({scrollTop:M},1000);J.find('input[type="text"]').removeClass("select_color");K.find('input[name="schoolName"]').focus();K.find('input[name="schoolName"]').addClass("select_color");var i=J.find(".mr_educationForm").length;if(i>0){L.siblings(".mrworkdel").show()}});$(".education .mrworkdel").hover(function(){$(this).addClass("pos")},function(){$(this).removeClass("pos")});$(".education").on("click",".mrworkdel",function(){var L=$(this);var J=$(".education .mr_educationForm:last input.eduHidden").val();if(J==""){var K=parseInt($(".mr_threeBasic").css("height"))-$(".education .mr_educationForm:last").outerHeight(true);$(".mr_threeBasic").css("height",K);L.parents(".adddel").prev(".mr_educationForm").remove();var i=L.parents(".adddel").siblings(".mr_educationForm").length;if(i==1){L.hide()}}else{$.ajax({type:"POST",url:ctx+"/educationExperience/delEdu.json",data:{id:J,resubmitToken:globals.token},dataType:"json"}).done(function(N){if(null!=N.resubmitToken&&""!=N.resubmitToken){globals.token=N.resubmitToken}if(N.success){var O=parseInt($(".mr_threeBasic").css("height"))-$(".education .mr_educationForm:last").outerHeight(true);$(".mr_threeBasic").css("height",O);L.parents(".adddel").prev(".mr_educationForm").remove();var M=L.parents(".adddel").siblings(".mr_educationForm").length;if(M==1){L.hide()}}else{alert(N.msg)}})}});function h(){$(".mr_educationForm").each(function(){$(this).validate({rules:{schoolName:{required:true,checkNum:true,maxlenStr:50,newSpecialChar:true},yourMajor:{required:true,checkNum:true,maxlenStr:50,newSpecialChar:true},degree:{required:true},schoolEnd:{required:true}},messages:{schoolName:{required:"必填",checkNum:"请输入有效的学校名称",maxlenStr:"请输入有效的学校名称",newSpecialChar:"请输入有效的学校名称"},yourMajor:{required:"必填",checkNum:"请输入有效的专业名称",maxlenStr:"请输入有效的专业名称",newSpecialChar:"请输入有效的专业名称"},degree:{required:"必填"},schoolEnd:{required:"必填"}},errorPlacement:function(i,J){$(".mr_threeBasic").css("height","auto");if(J.attr("name")=="degree"){i.insertAfter(J.siblings("ul"))}else{if(J.attr("name")=="schoolEnd"){i.insertAfter(J.siblings("ul"))}else{i.insertAfter(J)}}}})})}h();$(".education").on("click",'input[type="submit"]',function(){var i=true;$(".education .mr_educationForm").each(function(){h();var K=$(this).valid();if(!K){i=false}});if(i){var J=$(".education");d(J)}});function d(J){J.find('input[type="submit"]').attr("disabled",true);var i=$(".mr_educationFormTop",J);var L=$(".mr_educationFormTop",J).length;var R=$("#isWork").val();if(R=="0"){R=2}else{R=3}var O=[];for(var M=0;M<L;M++){var P=$(i[M]).find('input[name="schoolName"]').val();var T=$(i[M]).find('input[name="yourMajor"]').val();var K=$(i[M]).find('input[name="degree"]').val();var S=$(i[M]).find('input[name="schoolEnd"]').val();var Q=$(i[M]).find("input.eduHidden").val();var N={};N.schoolName=P;N.professional=T;N.education=K;N.endDate=S;N.id=Q;O.push(N)}O=stringifyJSON(O);$.ajax({url:ctx+"/educationExperience/saveEduList.json",type:"post",data:{eduJson:O,resubmitToken:globals.token,indVal:R},dataType:"json"}).done(function(W){if(null!=W.resubmitToken&&""!=W.resubmitToken){globals.token=W.resubmitToken}if(W.success){var Z=W.content.educationExperiences;var V=Z.length;var Y=$(".education input.eduHidden");for(var X=0;X<V;X++){$(Y[X]).val(Z[X].id)}var U;U=$(".mr_self").height();if(R==2){U=$(".mr_eduation").height();$(".mr_enoughWidth").animate({marginLeft:"-540px"},300,function(){$(".mr_threeBasic").css("height",U)});$(".mr_icon li:eq(1)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon")}else{$(".mr_enoughWidth").animate({marginLeft:"-1080px"},300,function(){$(".mr_threeBasic").css("height",U)});$(".mr_icon li:eq(2)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon")}}else{alert(W.msg)}J.find('input[type="submit"]').attr("disabled",false)})}$(".mr_exampleicon").click(function(){$(".mr_exampleCon").toggle();if($(this).hasClass("mr_color")){$(".mr_exampleicon").removeClass("mr_color");$(".mr_exampleicon span").html("查看示例");$(this).find("em").removeClass("pos")}else{$(this).addClass("mr_color");$(".mr_exampleicon span").html("收起示例");$(this).find("em").addClass("pos")}});$(".education .mr_button a").click(function(){var i=$(".mr_workexp").height();$(".mr_threeBasic").css("height",i);var J=$("#resumeId").val();$.ajax({url:ctx+"/resume/pageSkip.json",type:"post",data:{resumeId:J,indVal:1,resubmitToken:globals.token},dataType:"json"}).done(function(L){if(null!=L.resubmitToken&&""!=L.resubmitToken){globals.token=L.resubmitToken}if(L.success){var K=$(".mr_workexp").outerHeight(true);$(".mr_enoughWidth").animate({marginLeft:"0px"},300,function(){$(".mr_threeBasic").css("height",K)});$(".mr_icon li:eq(0)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon")}})});$(".practice .mr_button a").click(function(){var i=$(".mr_workexp").height();$(".mr_threeBasic").css("height",i);var J=$("#resumeId").val();$.ajax({url:ctx+"/resume/pageSkip.json",type:"post",data:{resumeId:J,indVal:1,resubmitToken:globals.token},dataType:"json"}).done(function(L){if(null!=L.resubmitToken&&""!=L.resubmitToken){globals.token=L.resubmitToken}if(L.success){var K=$(".mr_workexp").outerHeight(true);$(".mr_enoughWidth").animate({marginLeft:"0px"},300,function(){$(".mr_threeBasic").css("height",K)});$(".mr_icon li:eq(0)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon")}})});$(".mr_self .mr_button a").click(function(){var i=$(".mr_eduation").height();$(".mr_threeBasic").css("height",i);var J=$("#resumeId").val();$.ajax({url:ctx+"/resume/pageSkip.json",type:"post",data:{resumeId:J,indVal:2,resubmitToken:globals.token},dataType:"json"}).done(function(L){if(null!=L.resubmitToken&&""!=L.resubmitToken){globals.token=L.resubmitToken}if(L.success){var K=$(".mr_eduation").height();$(".mr_enoughWidth").animate({marginLeft:"-540px"},300,function(){$(".mr_threeBasic").css("height",K)});$(".mr_icon li:eq(1)").addClass("mr_workYearIcon").siblings().removeClass("mr_workYearIcon")}})});function q(L){var J=0;for(var K=0;K<L.length;K++){var M=L.charCodeAt(K);if((M>=1&&M<=126)||(65376<=M&&M<=65439)){J++}else{J+=2}}return J}$(".mr_introduceSelf").on("keyup","textarea",function(){var J=$(this);var K=$.trim(J.val());var i=q(K);if(i==0){J.siblings("span.mroneError").text("必填").show().css("margin","5px 0 -10px");J.siblings(".mr_wordcount").children("span").text(58-i)}else{if(i<4){J.siblings("span.mroneError").text("太短了").show().css("margin","5px 0 -10px");J.siblings(".mr_wordcount").children("span").text(58-i)}else{if(i>=4&&i<=58){J.siblings("span.mroneError").hide();J.siblings(".mr_wordcount").children("span").text(58-i)}else{if(i>58){J.siblings(".mr_wordcount").children("span").text(0);J.siblings("span.mroneError").text("请输入4-58个字符的介绍").show().css("margin","5px 0 -10px")}}}}});$('.mr_introduceSelf input[type="submit"]').click(function(){var L=$("#isWork").val();if(L==0){ga("send","event","应届生","一句话","done")}else{ga("send","event","非应届生","一句话","done")}var K=$(this);var L=$.trim($(".mr_introduceSelf textarea").val());var i=q(L);if(i==0||L=="一句话介绍自己，告诉我为什么选择你而不是别人"){K.parents(".mr_button").siblings(".selfCon").find("span.mroneError").text("必填").show().css("margin","5px 0 -10px")}else{if(i<4){K.parents(".mr_button").siblings(".selfCon").find("span.mroneError").text("太短了").show().css("margin","5px 0 -10px")}else{if(i>=4&&i<=58){$('.mr_self input[type="submit"]').attr("disabled",true);K.parents(".mr_button").siblings(".selfCon").find("span.mroneError").hide().css("marginTop","1px");var J=$.trim($(".mr_introduceSelf textarea").val());var M=$("#resumeId").val();$.ajax({url:ctx+"/resume/oneWord.json",type:"post",data:{oneWord:J,resubmitToken:globals.token,id:M,indVal:1},dataType:"json"}).done(function(N){if(null!=N.resubmitToken&&""!=N.resubmitToken){globals.token=N.resubmitToken}if(N.success){if(N.code==1){window.location.href=ctx+"/plus/guide.html"}else{window.location.href=paictx+"/applyGuide.html?from=resume_threestep"}}else{alert(N.msg)}$('.mr_self input[type="submit"]').attr("disabled",false)})}else{if(i>58){field.siblings(".mr_wordcount").children("span").text(0);K.parents(".mr_button").siblings(".selfCon").find("span.mroneError").text("请输入4-58个字符的介绍").show().css("margin","5px 0 -10px")}}}}});var p=(function(){var M=$("#uploadImages");var O=M.find("#cropzoom_container");var K=M.find("#crop");var J=M.find("#restore");var i;K.bind("click",function(){i.send(ctx+"/resume/cutPic.json","POST",{resubmitToken:globals.token},function(P){if(null!=P.resubmitToken&&""!=P.resubmitToken){globals.token=P.resubmitToken}i.showImage.attr("src",ctx+"/"+P.content.uploadPath+"?cc="+Math.random());$.colorbox.close();i.showImage=null;$(".mr_headhover").hide();$(".mr_headfile").hover(function(){$(".mr_headhover").show()},function(){$(".mr_headhover").hide()});i.restore()})});J.bind("click",function(){$.colorbox.close();$(".mr_headhover").hide();$(".mr_headfile").hover(function(){$(".mr_headhover").show()},function(){$(".mr_headhover").hide()})});var L=function(P,Q){var S=$(".mr_headimg");var R=ctx+"/"+P.uploadPath;$.colorbox({inline:true,href:M,title:"选择裁剪区域"});myresumeCommon.config.cutImage.image.source=R;myresumeCommon.config.cutImage.image.width=P.srcImageW;myresumeCommon.config.cutImage.image.height=P.srcImageH;myresumeCommon.config.cutImage.selector.w=myresumeCommon.config.userPhotoSelector.width;myresumeCommon.config.cutImage.selector.h=myresumeCommon.config.userPhotoSelector.height;i=O.cropzoom(myresumeCommon.config.cutImage);i.showImage=null;i.showImage=S};var N=function(){};return{upSucc:L,upFail:N}})();window.uploadPhoto=p;$("#colorbox").on("click","#cboxClose",function(){if($(this).siblings("#cboxLoadedContent").children("div").attr("id")=="uploadImages"){$(".mr_headhover").hide();$(".mr_headfile").hover(function(){$(".mr_headhover").show()},function(){$(".mr_headhover").hide()})}})});function img_check(obj,action_url,id){var obj=$("#"+id);this.AllowExt=".jpg,.gif,.jpeg,.png";this.FileExt=obj.val().substr(obj.val().lastIndexOf(".")).toLowerCase();if(this.AllowExt!=0&&this.AllowExt.indexOf(this.FileExt)==-1){alert("目前仅支持10MB以内的PNG/JPG/JPEG/GIF图片")}else{$("#"+id+"_error").text("").hide();$.ajaxFileUpload({type:"POST",url:action_url,secureuri:false,fileElementId:id,data:{headPic:obj.val()},dataType:"text",success:function(data){var data=eval("("+data+")");if(data.msg){var url=data.content;$.colorbox({inline:true,href:$("#uploadImages"),title:"选择显示区域"});var url=data.content;var cropzoom=$("#cropzoom_container").cropzoom({width:175,height:175,bgColor:"#ccc",enableRotation:false,enableZoom:true,selector:{w:128,h:128,showPositionsOnDrag:true,showDimetionsOnDrag:false,centered:true,bgInfoLayer:"#fff",borderColor:"#02d1a1",animated:false,maxWidth:150,maxHeight:200,borderColorHover:"#02d1a1"},image:{source:ctx+"/"+url,width:175,height:175,minZoom:30,maxZoom:150}});$("#crop")[0].onclick=function(){cropzoom.send(ctx+"/resume/cutPic.json","POST",{},function(imgRet){$(".mr_headimg").attr("src",ctx+"/"+imgRet.content+"?cc="+Math.random());$.colorbox.close()})};$("#restore")[0].onclick=function(){cropzoom.restore();$.colorbox.close()}}else{alert("目前仅支持10MB以内的PNG/JPG/JPEG/GIF图片")}},error:function(data){alert("目前仅支持10MB以内的PNG/JPG/JPEG/GIF图片")}})}};
